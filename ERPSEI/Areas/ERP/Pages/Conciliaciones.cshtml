@page "{handler?}"
@model ERPSEI.Areas.ERP.Pages.ConciliacionesModel
@using Microsoft.AspNetCore.Localization;
@using Microsoft.AspNetCore.Mvc.Localization;
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer;
@{
    ViewData["Title"] = Localizer["Title"];

    // Retrieves the requested culture
    IRequestCultureFeature? rqf = Request.HttpContext.Features.Get<IRequestCultureFeature>();

    // Culture contains the information of the requested culture
    System.Globalization.CultureInfo? culture = rqf != null ? rqf.RequestCulture.Culture : new System.Globalization.CultureInfo("es-MX");

    string cultureName = culture.Name;
}

<h3 class="title mb-3">@ViewData["Title"]</h3>

<!-- --------------------------- -->
<!-- Sección de filtros -------- -->
<div class="accordion shadow mb-5" id="accordionFiltros">
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button p-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                <h6>@Localizer["FilterTitle"]</h6>
            </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionFiltros">
            <div class="accordion-body">
                <form id="filtros" method="post">
                    <div class="row">
                        <div class="col-sm-6 col-md-6 col-lg-3">
                            <div class="form-floating mb-3">
                                <input id="inpFiltroId" type="text" asp-for="InputFiltro.Id" class="form-control" placeholder="@Localizer["IdField"]" />
                                <label for="inpFiltroId" asp-for="InputFiltro.Id" class="form-label"></label>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-3">
                            <div class="form-floating mb-3">
                                <input id="inpFiltroCliente" type="text" asp-for="InputFiltro.Cliente" class="form-control" placeholder="@Localizer["ClienteField"]" />
                                <label for="inpFiltroCliente" asp-for="InputFiltro.Cliente" class="form-label"></label>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-3">
                            <div class="form-floating mb-3">
                                <input id="inpFiltroUsuarioCreo" type="text" asp-for="InputFiltro.UsuarioCreador" class="form-control" placeholder="@Localizer["UsuarioCreoField"]" />
                                <label for="inpFiltroUsuarioCreo" asp-for="InputFiltro.UsuarioCreador" class="form-label"></label>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-3">
                            <div class="form-floating mb-3">
                                <input id="inpFiltroUsuarioModifico" type="text" asp-for="InputFiltro.UsuarioModificador" class="form-control" placeholder="@Localizer["UsuarioModificoField"]" />
                                <label for="inpFiltroUsuarioModifico" asp-for="InputFiltro.UsuarioModificador" class="form-label"></label>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-3">
                            <div class="form-floating mb-3">
                                <input id="inpFiltroFechaElaboracionInicio" type="date" asp-for="InputFiltro.FechaElaboracionInicio" class="form-control" placeholder="@Localizer["FechaElaboracionInicioField"]" />
                                <label for="inpFiltroFechaElaboracionInicio" asp-for="InputFiltro.FechaElaboracionInicio" class="form-label"></label>
                            </div>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-3">
                            <div class="form-floating mb-3">
                                <input id="inpFiltroFechaElaboracionFin" type="date" asp-for="InputFiltro.FechaElaboracionFin" class="form-control" placeholder="@Localizer["FechaElaboracionFinField"]" />
                                <label for="inpFiltroFechaElaboracionFin" asp-for="InputFiltro.FechaElaboracionFin" class="form-label"></label>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="row text-end">
                    <div class="col-12">
                        <button id="btnBuscar" class="btn btn-primary" onclick="onBuscarClick();">
                            <i class="bi bi-search"></i> @Localizer["SearchButton"]
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- --------------------------- -->
<!-- Sección tabla de resultados -->
<div id="toolbar" class="col-xl-12">
    <button id="btnAgregar" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#dlgConciliacion" onclick="onAgregarClick();">
        <i class="bi bi-plus-lg"></i> <span class="d-none d-sm-inline">@Localizer["AddButton"]</span>
    </button>
    <button id="remove" class="btn btn-danger" disabled>
        <i class="bi bi-ban"></i> <span class="d-none d-sm-inline">@Localizer["DeactivateButton"]</span>
    </button>
</div>
<!-- --------------------------- -->
<!-- --------------------------- -->
<table id="table" class="table-sm"
       data-unique-id="id"
       data-toolbar="#toolbar"
       data-search="true"
       data-show-toggle="true"
       data-show-fullscreen="true"
       data-show-columns="true"
       data-show-columns-toggle-all="true"
       data-detail-view="true"
       data-show-export="false"
       data-click-to-select="true"
       data-detail-formatter="detailFormatter"
       data-minimum-count-columns="2"
       data-show-pagination-switch="true"
       data-pagination="true"
       data-id-field="id"
       data-page-list="[10, 25, 50, 100, all]"
       data-show-footer="false"
       data-side-pagination="client"
       data-response-handler="responseHandler"
       data-buttons-class="primary"
       data-url="/ERP/Conciliaciones/ConciliacionesList"> <!--Verificar esta linea de codigo-->
    <thead>
        <tr align="center" valign="middle" class="bg-primary bg-opacity-10">
        </tr>
    </thead>
</table>

<!-- --------------------------- -->
<!-- Sección Nuevo/Editar/Ver Registro -->
<div id="dlgConciliacion" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="dlgConciliacionTitle" class="modal-title"></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="theForm" method="post">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div id="saveValidationSummary" class="text-danger mb-3" role="alert"></div>
                        <div class="row">
                            <div class="col-3">
                                <div class="form-floating mb-3">
                                    <input id="inpConciliacionId" asp-for="InputFiltro.Id" type="text" class="form-control" placeholder="@Localizer["IdPlaceholder"]" />
                                    <label asp-for="InputFiltro.Id"></label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="form-floating mb-3">
                                    <input id="inpConciliacionFecha" asp-for="InputFiltro.Fecha" type="text" class="form-control" placeholder="@Localizer["ClientePlaceholder"]" />
                                    <label asp-for="InputFiltro.Cliente"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="dlgConciliacionBtnCancelar" type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg"></i> @Localizer["CancelButton"]
                    </button>
                    <button id="dlgConciliacionBtnGuardar" type="button" class="btn btn-primary">
                        <i class="bi bi-floppy"></i> @Localizer["SaveButton"]
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <link rel="stylesheet" href="~/lib/bootstrap-table/bootstrap-table.min.css">
    <link rel="stylesheet" href="~/lib/jquery-ui/jquery-ui.min.css">
    <script src="~/lib/jquery-ui/jquery-ui.min.js"></script>
    <script src="~/js/autocompletar.js"></script>

    <script src="~/lib/bootstrap-table/extensions/export/tableExport.min.js"></script>
    <script src="~/lib/bootstrap-table/bootstrap-table.min.js"></script>+
    <script src="~/lib/bootstrap-table/locale/bootstrap-table-es-MX.min.js"></script>
    <script src="~/lib/bootstrap-table/locale/bootstrap-table-en-US.min.js"></script>
    <script src="~/lib/bootstrap-table/extensions/export/bootstrap-table-export.min.js"></script>
    <script src="~/lib/bootstrap-table/extensions/export/xlsx.full.min.js"></script>
    <script src="~/lib/bootstrap-table/extensions/export/exceljs.min.js"></script>
    <script src="~/lib/bootstrap-table/extensions/export/FileSaver.min.js"></script>

    <link rel="stylesheet" href="~/css/Conciliaciones.css" />
    <script src="~/../Areas/ERP/Pages/Conciliaciones.cshtml.js"></script>

    <script type="text/javascript">
        var cultureName = "@cultureName";
        var btnImportarText = '@Localizer["ImportButtonText"]';
        var btnImportarTitle = '@Localizer["ImportButtonTitle"]';
        var btnInvitarTitle = '@Localizer["InviteButtonTitle"]';
        var btnVerTitle = '@Localizer["SeeButtonTitle"]';
        var btnEditarTitle = '@Localizer["EditButtonTitle"]';
        var btnEliminarTitle = '@Localizer["DeleteButton"]';
        var dlgEditarTitle = '@Localizer["EditDialogTitle"]';
        var dlgVerTitle = '@Localizer["SeeDialogTitle"]';
        var dlgNuevoTitle = '@Localizer["NewDialogTitle"]';
        var dlgDeleteTitle = '@Localizer["DeleteEmpleadoDialogTitle"]';
        var dlgDeleteQuestion = '@Localizer["DeleteEmpleadoDialogQuestion"]';
        var dlgDeleteTitle = '@Localizer["DeletePositionDialogTitle"]';
        var dlgDeleteQuestion = '@Localizer["DeletePositionDialogQuestion"]';
        
        /*Tabla de resultados*/
        var colIdHeader = '@Localizer["colIdHeader"]';
        var colFechaHeader = '@Localizer["ColDateHeader"]';
        var colDescripcionHeader = '@Localizer["ColDescriptionHeader"]';
        var colClienteHeader = '@Localizer["ColCustomerHeader"]';
        var colTotalHeader = '@Localizer["ColTotalHeader"]';
        var colUsuarioCreadorHeader = '@Localizer["ColCreatedUserHeader"]';
        var colUsuarioModificoHeader = '@Localizer["ColModifyUserHeader"]';
        var colAccionesHeader = '@Localizer["ColActionsHeader"]';
    </script>

    <partial name="_ValidationScriptsPartial" />
}

