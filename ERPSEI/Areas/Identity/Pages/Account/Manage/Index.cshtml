@page
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model IndexModel
@{
    ViewData["Title"] = Localizer["Title"];
    ViewData["ActivePage"] = ManageNavPages.Index;
}

<h3>@ViewData["Title"]</h3>
<br />
<h5>@Localizer["FirstSectionTitle"]</h5>
<partial name="_StatusMessage" for="StatusMessage" />
<div class="row">
    <div class="col-lg-6">
        <center>
            <div>
                <img id="profilePicContainer" class="profile-pic" src="@this.HttpContext.Request.Scheme://@this.HttpContext.Request.Host/img/default_profile_pic.jpg" />
            </div>
            <div style="width:auto;" class="mb-3">
                <input type="file" id="profilePicSelector" onchange="onFileChanged(this);" hidden/>
                <a id="editProfilePicLink" href="#" onclick="openFileDialog();">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                        <path d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z" />
                    </svg>
                    @Localizer["EditLink"]
                </a>
            </div>
        </center>
    </div>
    <div class="col-lg-6">
        <form id="profile-form" method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>
            <div class="form-floating mb-3">
                <input asp-for="Input.Username" class="form-control" placeholder="@Localizer["UsernamePlaceholder"]" />
                <label asp-for="Input.Username" class="form-label"></label>
            </div>
            <div class="row">
                <div class="form-floating mb-3 col-lg-6">
                    <input asp-for="Input.FirstName" class="form-control" placeholder="@Localizer["FirstNamePlaceholder"]" />
                    <label asp-for="Input.FirstName" style="left: 10px;" class="form-label"></label>
                </div>
                <div class="form-floating mb-3 col-lg-6">
                    <input asp-for="Input.SecondName" class="form-control" placeholder="@Localizer["SecondNamePlaceholder"]" />
                    <label asp-for="Input.SecondName" style="left: 10px;" class="form-label"></label>
                </div>
            </div>
            <div class="row">
                <div class="form-floating mb-3 col-lg-6">
                    <input asp-for="Input.FathersLastName" class="form-control" placeholder="@Localizer["FathersLastNamePlaceholder"]" />
                    <label asp-for="Input.FathersLastName" style="left: 10px;" class="form-label"></label>
                </div>
                <div class="form-floating mb-3 col-lg-6">
                    <input asp-for="Input.MothersLastName" class="form-control" placeholder="@Localizer["MothersLastNamePlaceholder"]" />
                    <label asp-for="Input.MothersLastName" style="left: 10px;" class="form-label"></label>
                </div>
            </div>
            <div class="form-floating mb-3">
                <input asp-for="Input.PhoneNumber" class="form-control" placeholder="@Localizer["PhonePlaceholder"]" />
                <label asp-for="Input.PhoneNumber" class="form-label"></label>
                <span asp-validation-for="Input.PhoneNumber" class="text-danger"></span>
            </div>
            <button id="update-profile-button" type="submit" class="w-100 btn btn-lg btn-primary">@Localizer["SaveButton"]</button>
        </form>
    </div>
</div>
<hr />
<h5>@Localizer["SecondSectionTitle"]</h5>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script type="text/javascript">
        function openFileDialog() {
            let input = document.getElementById("profilePicSelector");
            input.click();
        }
        function onFileChanged(input) { 
            if (input.files && (input.files.length||0) >= 1) {
                // Check FileReader support
                if (FileReader) {
                    var fr = new FileReader();
                    fr.onload = function () {
                        document.getElementById("profilePicContainer").src = fr.result;
                    }
                    fr.readAsDataURL(input.files[0]);
                }
            }
        }
    </script>
}
